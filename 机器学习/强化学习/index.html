
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="路漫漫其修远兮，吾将上下而求索">
      
      
        <meta name="author" content="xiaofei">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>强化学习 - 小飞的博客</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
          
          
          <meta name="theme-color" content="#02a6f2">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="小飞的博客" class="md-header__button md-logo" aria-label="小飞的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            小飞的博客
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              强化学习
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="小飞的博客" class="md-nav__button md-logo" aria-label="小飞的博客" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    小飞的博客
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          数学
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="数学" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          数学
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%95%B0%E5%AD%A6/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" class="md-nav__link">
        计算机图形学
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E6%95%B0%E5%AD%A6/%E6%A6%82%E7%8E%87%E8%AE%BA/" class="md-nav__link">
        概率论
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          机器学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="机器学习" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          机器学习
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../TransFormer/" class="md-nav__link">
        TransFormer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch/" class="md-nav__link">
        Pytorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%BD%BF%E7%94%A8%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        github模型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%B8%B8%E7%94%A8%E6%A6%82%E5%BF%B5/" class="md-nav__link">
        常用概念
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          强化学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        强化学习
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    马尔科夫链
  </a>
  
    <nav class="md-nav" aria-label="马尔科夫链">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sstate" class="md-nav__link">
    S（state）状态
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aaction" class="md-nav__link">
    A（action）动作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rreward" class="md-nav__link">
    R（reward）奖励
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qv" class="md-nav__link">
    Q&amp;V
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcv" class="md-nav__link">
    蒙地卡罗(MC)估算状态V值
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tdv" class="md-nav__link">
    时序差分(TD)估算状态V值
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qlearning" class="md-nav__link">
    Qlearning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dqn" class="md-nav__link">
    DQN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actor-critic" class="md-nav__link">
    Actor-Critic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddpg" class="md-nav__link">
    DDPG
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../%E6%95%B0%E6%8D%AE%E9%99%8D%E7%BB%B4/" class="md-nav__link">
        数据降维
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          编程
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="编程" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          编程
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/conda/" class="md-nav__link">
        Conda
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/draw/" class="md-nav__link">
        python 绘图
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/fastapi/" class="md-nav__link">
        FastApi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/ffmpeg/" class="md-nav__link">
        Ffmpeg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/git/" class="md-nav__link">
        Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/jupyter/" class="md-nav__link">
        Jupyter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/manimgl/" class="md-nav__link">
        Manimgl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/micropython/" class="md-nav__link">
        MicroPython的学习
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/mkdocs/" class="md-nav__link">
        mkdocs的使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/wsl/" class="md-nav__link">
        WSL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BC%96%E7%A8%8B/%E8%A3%85%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        装系统
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          计算化学
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="计算化学" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          计算化学
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E5%8C%96%E5%AD%A6/gaussian/" class="md-nav__link">
        Gaussian
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E5%8C%96%E5%AD%A6/gto/" class="md-nav__link">
        高斯型波函数
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E5%8C%96%E5%AD%A6/pyscf/" class="md-nav__link">
        pyscf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E5%8C%96%E5%AD%A6/%E5%8A%9B%E5%9C%BA/" class="md-nav__link">
        力场
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E5%8C%96%E5%AD%A6/%E5%8F%8D%E5%BA%94%E6%8C%87%E6%A0%87/" class="md-nav__link">
        反应指标
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E5%8C%96%E5%AD%A6/%E5%9F%BA%E7%BB%84/" class="md-nav__link">
        基组
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E5%8C%96%E5%AD%A6/%E6%B3%A2%E5%87%BD%E6%95%B0%E5%88%86%E6%9E%90/" class="md-nav__link">
        波函数分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%A1%E7%AE%97%E5%8C%96%E5%AD%A6/%E9%87%8F%E5%8C%96%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        量化笔记
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          读论文
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="读论文" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          读论文
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AF%BB%E8%AE%BA%E6%96%87/" class="md-nav__link">
        导航
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AF%BB%E8%AE%BA%E6%96%87/2022-11-2/" class="md-nav__link">
        2022-11-2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AF%BB%E8%AE%BA%E6%96%87/2022-11-21/" class="md-nav__link">
        2022 11 21
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AF%BB%E8%AE%BA%E6%96%87/2022-11-3/" class="md-nav__link">
        2022-11-3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AF%BB%E8%AE%BA%E6%96%87/2022-12-2/" class="md-nav__link">
        2022 12 2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    马尔科夫链
  </a>
  
    <nav class="md-nav" aria-label="马尔科夫链">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sstate" class="md-nav__link">
    S（state）状态
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aaction" class="md-nav__link">
    A（action）动作
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rreward" class="md-nav__link">
    R（reward）奖励
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qv" class="md-nav__link">
    Q&amp;V
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcv" class="md-nav__link">
    蒙地卡罗(MC)估算状态V值
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tdv" class="md-nav__link">
    时序差分(TD)估算状态V值
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qlearning" class="md-nav__link">
    Qlearning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dqn" class="md-nav__link">
    DQN
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actor-critic" class="md-nav__link">
    Actor-Critic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ddpg" class="md-nav__link">
    DDPG
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>强化学习</h1>

<h2 id="_1">马尔科夫链</h2>
<p>https://zhuanlan.zhihu.com/p/109217883</p>
<h3 id="sstate">S（state）状态</h3>
<p>状态就是智能体观察到的当前环境的部分或者全部特征。</p>
<h3 id="aaction">A（action）动作</h3>
<p>智能体做出的具体行为
<code>动作空间</code>就是该智能体能够做出的动作数量。</p>
<h2 id="rreward">R（reward）奖励</h2>
<p>当我们在某个状态下，完成动作。环境就会给我们反馈，告诉我们这个动作的效果如何。这种效果的数值表达，就是奖励。
奖励的设定是主观的，也就是说我们为了智能体更好地学习工作，自己定的。</p>
<h2 id="qv">Q&amp;V</h2>
<p>R只考虑当下
- 评估<code>动作</code>的价值，我们称为<code>Q值</code>：它代表了智能体选择这个动作后，一直到最终状态奖励总和的期望； 
- 评估<code>状态</code>的价值，我们称为<code>V值</code>：它代表了智能体在这个状态下，一直到最终状态的奖励总和的期望。
V值是会根据不同的策略有所变化的！
与V值不同，Q值和策略并没有直接相关，而与环境的状态转移概率相关，而环境的状态转移概率是不变的。</p>
<p>Q到V
$$
v_\pi(s)=\sum_{a\in A}\pi(a|s)q_\pi(s,a)
$$
V到Q
$$
q_\pi(s,a)=R_{s}^a+\gamma\sum_{s'}P_{ss'}^av_pi(s')
$$</p>
<h2 id="mcv">蒙地卡罗(MC)估算状态V值</h2>
<p>G值：从状态某个状态S到最终状态的总收获。</p>
<p>V是G的平均数。</p>
<h2 id="tdv">时序差分(TD)估算状态V值</h2>
<p>$$
V(S_t)=V(S_t)+\alpha[R_{t+1}+\gamma V(S_t+1)-V(S_t)]
$$
在TD(0)中，使用<code>下一状态的V</code>加上<code>状态转移奖励</code>作为更新目标</p>
<h2 id="qlearning">Qlearning</h2>
<p>需要一个QTable，存储Q值，其中每一行代表一个状态，每一列代表状态对应的行为的Q值，当遇到一个状态时，查询对应状态的所有应为的分数，按照最大的分数选择行为。
https://github.com/louisnino/RLcode/blob/master/tutorial_Qlearning.py
只适用于状态空间有限的情况</p>
<h2 id="dqn">DQN</h2>
<p>Deep network + Qlearning = DQN</p>
<p>DQN更新: <span class="arithmatex">\(Q(S,A)=Q(S,A)+\alpha[R+\gamma \max_{\alpha}Q(S',a)-Q(S,A)]\)</span>
- 其实DQN就是Qlearning扔掉Qtable，换上深度神经网络。
- 我们知道，解决连续型问题，如果表格不能表示，就用函数，而最好的函数就是深度神经网络。
- 和有监督学习不同，深度强化学习中，我们需要自己找更新目标。通常在马尔科夫链体系下，两个相邻状态状态差一个奖励r经常能被利用。</p>
<p>https://github.com/louisnino/RLcode/blob/master/tutorial_DQN.py</p>
<p>代码实现，以寻找二维平面最低点为例<br />
首先要定义环境，该环境包含智能体的状态，即位置。
环境要有一个reset函数，调用的时候会重新设置环境的状态。
环境还有有一个step函数，传入的是动作序号(动作的数量是一定的：上下左右移动)，该函数会对环境进行更新，并且返回更新后获得的新状态、奖励、以及是否结束。</p>
<pre><code class="language-python">class Env:
    def __init__(self) -&gt; None:
        ...

    def pes(self,pos):
        &quot;&quot;&quot;势能面&quot;&quot;&quot;
        x,y=pos
        return x**2+y**2

    def reset(self):
        self.pos=np.random.rand(2)*10-5
        self.e=self.pes(self.pos)
        return self.pos

    def step(self,a:int):
        ms=np.array([
            [ 1,0],
            [-1,0],
            [0,1 ],
            [0,-1]
        ])*0.1
        pos=self.pos+ms[a]
        e=self.pes(pos)
        r=1 if (self.e-e)&gt;0 else -1 #能量降低，奖励为正，能量升高，奖励为负
        d=True if (e&gt; self.e+10) else False
        self.pos=pos
        self.e=e
        return pos,r,d
</code></pre>
<p>然后需要定义一个智能体，能够根据当前位置，进行分类，本例中为四分类，分别是每个每种行为对应的Q值</p>
<pre><code class="language-python">class Net(torch.nn.Module):
    def __init__(self) -&gt; None:
        super().__init__()
        self.linear=torch.nn.Sequential(
            torch.nn.Linear(2,2),
            torch.nn.ReLU(),
            torch.nn.Linear(2,4),
            torch.nn.ReLU(),
            torch.nn.Linear(4,4),
            torch.nn.Sigmoid()
        )

    def forward(self,pos:np.ndarray)-&gt;np.ndarray:
        pos=torch.from_numpy(pos).type(torch.float32)
        return self.linear(pos)
</code></pre>
<p>然后实例化环境和智能体，进行迭代训练，损失的计算方法如下：
1. 将当前的状态<span class="arithmatex">\(S_t\)</span>代入智能体计算出向量<span class="arithmatex">\(Q_t\)</span>
2. 选择其中最大的<span class="arithmatex">\(q\)</span>值对应的行为指标<span class="arithmatex">\(a_t\)</span>
3. 将<span class="arithmatex">\(a_t\)</span>代入环境更新获得新的状态<span class="arithmatex">\(S_{t+1}\)</span>以及奖励<span class="arithmatex">\(r\)</span>
4. 将<span class="arithmatex">\(S_{t+1}\)</span>代入智能体获得新的向量<span class="arithmatex">\(Q_{t+1}\)</span>
5. 找出其q值最大的指标<span class="arithmatex">\(a_{t+1}\)</span>
6. 拷贝一份原本的<span class="arithmatex">\(Q\)</span>，记为<span class="arithmatex">\(Q'\)</span>
7. 将<span class="arithmatex">\(Q'[a]\)</span>替换为 <span class="arithmatex">\(r+\lambda Q_{t+1}[a_{t+1}]\)</span>
8. <span class="arithmatex">\(Q'\)</span>与<span class="arithmatex">\(Q_t\)</span>之间的差距就是损失</p>
<pre><code class="language-python">env=Env()
net=Net()
loss_fn=torch.nn.MSELoss()
optimer=torch.optim.Adam(net.parameters())

for i in range(1000):
    total_loss=0
    total_reward=0
    s=env.reset()
    for j in range(1000):
        Q=net(s) #Q值向量
        a=torch.argmax(Q).item() #行为指标
        q=Q[a] #行为对应的Q值
        s_,r,d=env.step(a) # 根据行为迭代一次环境
        total_reward+=r
        Q_=net(s_) #下一步的Q值向量
        a_=torch.argmax(Q_).item() # 下一步的行为指标
        q_=Q_[a_] #下一步行为的Q值
        targetQ=Q.detach().numpy().copy()
        targetQ[a]=r+0.8*q_
        loss=loss_fn(Q,torch.from_numpy(targetQ))
        optimer.zero_grad()
        loss.backward()
        optimer.step()
        total_loss+=loss.item()
        s=s_
    print(f'{total_loss:&gt;10.4f}    {total_reward:&lt;4}    {i}/1000')
torch.save(net.state_dict(),'DGN.pt')
</code></pre>
<h2 id="actor-critic">Actor-Critic</h2>
<p>Actor-Critic，其实是用了两个网络：</p>
<p>两个网络有一个共同点，输入状态S:
- Actor，输出行为向量
- Critic，输出分数值</p>
<p>TD-error: <span class="arithmatex">\(\gamma \times V(s') + r - V(s)\)</span><br />
Critic的任务就是让TD-error尽量小。然后TD-error给Actor做更新。</p>
<h2 id="ddpg">DDPG</h2>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../%E5%B8%B8%E7%94%A8%E6%A6%82%E5%BF%B5/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 常用概念" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              常用概念
            </div>
          </div>
        </a>
      
      
        
        <a href="../%E6%95%B0%E6%8D%AE%E9%99%8D%E7%BB%B4/" class="md-footer__link md-footer__link--next" aria-label="Next: 数据降维" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              数据降维
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://cdn.bootcss.com/mathjax/3.0.5/es5/tex-mml-chtml.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
    
  </body>
</html>